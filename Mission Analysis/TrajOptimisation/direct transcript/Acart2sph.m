function [az_,el_,ro_] = Acart2sph(x,y,z,x_,y_,z_,x_a,y_a,z_a)
az_=(((x_a))/(y) - (2*(x_)*(y_))/(y)^2 - ((x)*(y_a))/(y)^2 + (2*(x)*(y_)^2)/(y)^3)/((x)^2/(y)^2 + 1) - (((2*(x)*(x_))/(y)^2 - (2*(x)^2*(y_))/(y)^3)*(((x_))/(y) - ((x)*(y_))/(y)^2))/((x)^2/(y)^2 + 1)^2;
el_=((3*(z)*(2*(x)*(x_) + 2*(y)*(y_) + 2*(z)*(z_))^2)/(4*((x)^2 + (y)^2 + (z)^2)^(5/2)) - ((z_)*(2*(x)*(x_) + 2*(y)*(y_) + 2*(z)*(z_)))/((x)^2 + (y)^2 + (z)^2)^(3/2) - ((z)*(2*(x)*(x_a) + 2*(x_)^2 + 2*(y)*(y_a) + 2*(y_)^2 + 2*(z)*(z_a) + 2*(z_)^2))/(2*((x)^2 + (y)^2 + (z)^2)^(3/2)) + ((z_a))/sqrt((x)^2 + (y)^2 + (z)^2))/sqrt(1 - (z)^2/((x)^2 + (y)^2 + (z)^2)) - ((((z)^2*(2*(x)*(x_) + 2*(y)*(y_) + 2*(z)*(z_)))/((x)^2 + (y)^2 + (z)^2)^2 - (2*(z)*(z_))/((x)^2 + (y)^2 + (z)^2))*(((z_))/sqrt((x)^2 + (y)^2 + (z)^2) - ((z)*(2*(x)*(x_) + 2*(y)*(y_) + 2*(z)*(z_)))/(2*((x)^2 + (y)^2 + (z)^2)^(3/2))))/(2*(1 - (z)^2/((x)^2 + (y)^2 + (z)^2))^(3/2));
ro_=(2*(x)*(x_a) + 2*(x_)^2 + 2*(y)*(y_a) + 2*(y_)^2 + 2*(z)*(z_a) + 2*(z_)^2)/(2*sqrt((x)^2 + (y)^2 + (z)^2)) - (2*(x)*(x_) + 2*(y)*(y_) + 2*(z)*(z_))^2/(4*((x)^2 + (y)^2 + (z)^2)^(3/2));
end

